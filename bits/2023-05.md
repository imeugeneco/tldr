# 2023-05

[052723] [API V2 전환과 DB 무중단 마이그레이션 후기](https://medium.com/29cm/api-v2-전환과-db-무중단-마이그레이션-후기-8b39eb0db566) 

- 좋아요 API의 V2 전환 & PostgreSQL 데이터를 MySQL로 무중단 마이그레이션 진행
- 데이터 행이 많아 시간 단위로 마이그레이션을 진행해야 했기에 서비스를 중단, 기존 데이터를 dump, 신규 시스템에 load하는 방법이 아닌 서비스 중단 없이 데이터를 신규 시스템에 스트리밍하여 동기화
- V1 인터페이스를 그대로 마이크로서비스에 포팅하는 대신, V1 API에서 좋아요 설정/해제 시 V2 API에 동기화가 가능하도록 이벤트를 발송하는 구조

나도 곧 100만 행을 훌쩍 넘는 찰리 로그 테이블 마이그레이션을 해야하는데 다른 곳들은 어떻게 했는지 궁금해서 DB 마이그레이션 후기 찾아보면서 본 글. 저번 마이그레이션때 파일이 꼬이면서 개발과 프로덕션 환경이 서로 맞지 않게된 것도 있고, 중단 걸고 할 정도는 아닌 것 같지만 경험도 없는데다가 호출이 가장 자주 일어나는 테이블 중 하나라 좀 막막하다.

